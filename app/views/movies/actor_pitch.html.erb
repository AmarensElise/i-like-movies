<div class="max-w-4xl mx-auto p-6">


  <div class="flex justify-end mb-4">
    <%= render "movie_actions", movie: @movie %>
  </div>

  <!-- Movie Details -->
  <div class="bg-white rounded-lg overflow-hidden mb-8">




    <div class="md:flex">
      <!-- Movie Poster -->
      <div class="md:w-1/3 lg:w-2/4">
        <% if @movie.poster_path.present? %>
          <img src="https://image.tmdb.org/t/p/w500<%= @movie.poster_path %>" alt="<%= @movie.title %>" class="w-full h-auto object-cover shadow-lg rounded-xl" />
        <% else %>
          <div class="w-full h-72 md:h-full bg-gray-200 flex items-center justify-center">
            <span class="text-gray-500">No Poster Available</span>
          </div>
        <% end %>
      </div>

      <!-- Movie Info -->
      <div class="p-6 md:w-2/3 lg:w-2/4">

      <div class="mb-2">
          <span class="text-gray-400 text-xl">
            <% if @movie.release_date.present? %>
            
               <%= @movie.release_date.strftime('%Y') %>
            <% else %>
              Release Date Unknown
            <% end %>
          </span>
        </div>

 <h1 class="text-4xl font-bold text-gray-900 mb-6 transition">
          <%= link_to @movie.title, movie_path(@movie), class: "hover:text-indigo-400" %>
        </h1>
        

         <div>
          <div class="grid grid-cols-2 gap-4 mb-6">
            <div>
                 <div class="flex items-center text-sm">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <%= @movie.runtime ? "#{@movie.runtime} min" : "N/A" %>
              </div>

              
            </div>
          </div>

        <!-- Additional movie info from TMDB -->
        <div class="mb-6">
          <h3 class="text-lg font-medium text-gray-800 mb-2">Overview</h3>
          <p class="text-gray-700">
            <%= @movie_details&.dig('overview') || "No overview available" %>
          </p>
        </div>


        <!-- Additional movie info from TMDB -->
        <div class="mb-6">
          <% genres = @movie_details&.dig('genres') || @movie&.genres %>
          <% if genres.present? && genres.any? %>
            <div class="flex flex-wrap -m-1">
              <% genres.each do |g| %>
                <% name = g.is_a?(Hash) ? g['name'] : (g.respond_to?(:name) ? g.name : g.to_s) %>
                <span class="m-2 inline-block bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm">
                  <%= name %>
                </span>
              <% end %>
            </div>
          <% else %>
            <p class="text-gray-700">No genres available</p>
          <% end %>
        </div>

           <%= render "availability", watch_providers: @watch_providers %>
    
        </div>
      </div>
    </div>
  </div>


  <% favorite_actor_ids = current_user.favorite_actors.pluck(:actor_id) %>
  <% starring_favorites = @cast.select { |role| favorite_actor_ids.include?(role.actor_id) } %>

        <% if starring_favorites.any? %>
          <div class="mb-6">
            <h3 class="text-sm font-medium text-gray-600 mb-2">
              Featuring<%= "s" if starring_favorites.size > 1 %>
            </h3>

            <div class="flex flex-wrap gap-3">
              <% starring_favorites.each do |role| %>
                <%= render partial: "actors/actor", collection: [role.actor], as: :actor %>
              <% end %>
            </div>
          </div>
        <% end %>

  <div class="mb-8 flex justify-center">
  <%= link_to "Pitch me another one",
      "/actor_pitch",
      class: "inline-flex items-center rounded-full bg-indigo-600 px-6 py-3 text-sm font-semibold text-white hover:bg-gray-800 transition",
      data: { turbo: false } %>
</div>

</div>
